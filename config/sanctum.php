<?php

use Laravel\Sanctum\Sanctum;

return [

    /*
    |--------------------------------------------------------------------------
    | 🏠 Доверенные (stateful) домены
    |--------------------------------------------------------------------------
    |
    | Указанные здесь домены будут считаться «доверенными» для хранения
    | cookie с токеном авторизации. Это важно для SPA, которые используют
    | cookie вместо заголовка Authorization.
    |
    | Пример:
    | SANCTUM_STATEFUL_DOMAINS=localhost,127.0.0.1:8000,my-site.ru
    |
    */
    'stateful' => explode(',', env('SANCTUM_STATEFUL_DOMAINS', sprintf(
        '%s%s',
        'localhost,localhost:3000,127.0.0.1,127.0.0.1:8000,::1',
        Sanctum::currentApplicationUrlWithPort(),
        // Sanctum::currentRequestHost(), // можно включить при необходимости
    ))),

    /*
    |--------------------------------------------------------------------------
    | 🛡️ Guard'ы для авторизации
    |--------------------------------------------------------------------------
    |
    | Указывается список guard'ов, которые будут проверяться для авторизации
    | через Sanctum. Обычно это "web", если используется cookie-based аутентификация.
    |
    */
    'guard' => ['web'],

    /*
    |--------------------------------------------------------------------------
    | ⏳ Время жизни токена (в минутах)
    |--------------------------------------------------------------------------
    |
    | Позволяет задать глобальное время истечения (expiration) токена.
    | Если установлено `null`, токен бессрочный (пока не будет отозван).
    | Не влияет на session-based SPA, только на токены API.
    |
    */
    'expiration' => null,

    /*
    |--------------------------------------------------------------------------
    | 🏷️ Префикс для токенов
    |--------------------------------------------------------------------------
    |
    | Добавляет префикс ко всем токенам, чтобы они легче распознавались
    | в публичных репозиториях и могли быть отсканированы GitHub и другими сервисами.
    |
    | Подробнее: https://docs.github.com/en/code-security/secret-scanning
    |
    */
    'token_prefix' => env('SANCTUM_TOKEN_PREFIX', ''),

    /*
    |--------------------------------------------------------------------------
    | ⚙️ Middleware Sanctum
    |--------------------------------------------------------------------------
    |
    | Здесь указываются middleware, которые Sanctum будет использовать
    | при авторизации через сессионные cookie (SPA).
    | Их можно переопределить при необходимости.
    |
    */
    'middleware' => [
        'authenticate_session' => Laravel\Sanctum\Http\Middleware\AuthenticateSession::class,
        'encrypt_cookies' => Illuminate\Cookie\Middleware\EncryptCookies::class,
        'validate_csrf_token' => Illuminate\Foundation\Http\Middleware\ValidateCsrfToken::class,
    ],
];
